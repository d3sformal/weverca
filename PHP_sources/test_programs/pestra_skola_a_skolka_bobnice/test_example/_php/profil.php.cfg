digraph g {node [shape=box]
 graph[rankdir="TB", concentrate=true];node0[label="Post
"]
node1[label="Form
global $_inf;
"]
node2[label="Body
global $_page;
Form()
"]
node3[label="Login
global $_inf;
"]
node4[label="Profil
"]
node5[label="Logout
session_unset()
MakeRefresh(\"index.php?\". GetLink(false) )
"]
node6[label="LoginForm
"]
node7[label="ProfilForm
$data = mysql_fetch_array( sql_select('users',\"id, name, AES_DECRYPT(mail, sha1(concat('\".MASTER_CODE.\"' , no1))) as mail\",
    \"where state != 0 and id = '$_SESSION[id]'\", 1
  ))
"]
node8[label=""]
node9[label="Profil()
"]
node10[label="Login()
"]
node11[label="return true;
"]
node12[label=""]
node13[label=""]
node14[label="return;
"]
node15[label=""]
node16[label="return;
"]
node17[label=""]
node18[label=""]
node19[label="return;
"]
node20[label="FormHead(\"Přihlášení\", \"$_inf[page]?$_SERVER[QUERY_STRING]\")
TextBox(\"Přihlašovací jméno\", 1, '', 3, 20)
PasswordBox(\"Heslo\", 2, '', 5, 20)
FormBottom('', \"'txt', 'txt'\", \"3,5\", \"20,20\")
"]
node21[label="Alert(\"Chyba, nelze nalézt uživatele\")
return;
"]
node22[label=""]
node23[label="die(\"<h1>Chyba vstupu</h1>\")
"]
node24[label=""]
node25[label=""]
node26[label=""]
node27[label="ProfilForm()
"]
node28[label="LoginForm()
"]
node29[label=""]
node30[label=""]
node31[label="return;
"]
node32[label="$data = mysql_fetch_array( sql_select('users','id, name, last_login, state',
    \"where state != 0 and name = '$name' and no2 = sha1( concat('\". SALT .\"$pass', no1) )\", 1
  ))
"]
node33[label=""]
node34[label=""]
node35[label="return;
"]
node36[label=""]
node37[label=""]
node38[label=""]
node39[label=""]
node40[label=""]
node41[label="return;
"]
node42[label="FormHead(\"Změna přihlašovacích údajů\", \"$_inf[page]?$_SERVER[QUERY_STRING]\")
"]
node43[label=""]
node44[label="Logout()
"]
node45[label="$_inf['post'] = true
Post
$_inf['form'] = true
Form
Body
Login
Profil
Logout
LoginForm
ProfilForm
"]
node46[label="return true;
"]
node47[label=""]
node48[label="$_inf['log'] = 'login'
"]
node49[label="ThrowFormError(0, \"Chybné uživatelské jméno nebo heslo\")
"]
node50[label="session_register(\"id\")
$_SESSION['id'] = $data['id']
session_register(\"name\")
$_SESSION['name'] = $data['name']
session_register(\"state\")
$_SESSION['state'] = $data['state']
sql_update('users', \"last_login = '\". date(\"y-m-d H:i:s\") .\"'\", \"state != 0 and name = '$name'\")
"]
node51[label=""]
node52[label="return;
"]
node53[label="ThrowFormError(4, \"Heslo a opakované heslo se musí shodovat\")
return;
"]
node54[label="return;
"]
node55[label="ThrowFormError(1, \"Přístup zamítnut - chybné heslo\")
return;
"]
node56[label="ThrowFormError(0, \"Neprovedl jste žádnou změnu\")
return;
"]
node57[label="sql_update('users', $dotaz, \"state != 0 and id = '$_SESSION[id]'\", 1)
MakeRefresh()
"]
node58[label=""]
node59[label=""]
node60[label="PasswordBox(\"Původní heslo\", 1, '', 5, 20)
TextBox(\"Přihlašovací jméno\", 2, $data['name'], 3, 20)
PasswordBox(\"Nové heslo\", 3, '', 5, 20, false)
PasswordBox(\"Potvrzení hesla\", 4, '')
TextBox(\"E-mailová adresa\", 5, $data['mail'])
FormBottom(\"Pokud ponecháte pole 'Nové heslo' nevyplněné, nedojde ke změně hesla.\",
    \"'txt','txt', 'not', 'psck', 'mail'\", \"5,3,5,0,0\", \"20,20,20,0,0\"
  )
"]
node61[label="Alert(\"Změňte si prosím heslo\")
"]
node62[label=""]
node63[label=""]
node64[label="MakeRefresh(\"$_inf[page]?$_SERVER[QUERY_STRING]\", 1)
"]
node65[label="MakeRefresh(\"$_inf[page]?\". preg_replace(\"/o=login&amp;?/\", \"\", $_SERVER['QUERY_STRING']))
"]
node66[label=""]
node67[label="$data = mysql_fetch_array( sql_select('users',\"state, id, name, AES_DECRYPT(mail, sha1(concat('\".MASTER_CODE.\"' , no1))) as mail\",
    \"where state != 0 and id = '$_SESSION[id]' and no2 = sha1( concat('\". SALT .\"$oldPas', no1) )\", 1
  ))
"]
node68[label=""]
node69[label=""]
node70[label=""]
node71[label=""]
node72[label="$dotaz = \"\"
"]
node73[label=""]
node74[label="$dotaz .= \"mail = AES_ENCRYPT('$mail', sha1(concat('\".MASTER_CODE.\"' , no1)) )\"
"]
node75[label="$dotaz .= \"mail = ''\"
"]
node76[label=""]
node77[label="$dotaz = \"name = '$name'\"
$_SESSION['name'] = $name
"]
node78[label=""]
node79[label=""]
node80[label=""]
node81[label=""]
node82[label="$dotaz .= \", state = '1'\"
$_SESSION['state'] = 1
"]
node83[label="$dotaz .= \"no2 = sha1( concat('\". SALT .\"$pass', no1) )\"
"]
node84[label=""]
node85[label="$dotaz .= \", \"
"]
node86[label="$dotaz .= \", \"
"]
node0 -> node9[headport=n, tailport=s,label="IsLoged()"]
node0 -> node10[headport=n, tailport=s,label=" else  "]
node1 -> node11[headport=n, tailport=s,label="$_GET['o'] == 'logout' and IsRefreshed(\"Byl jste odhlášen\")"]
node1 -> node12[headport=n, tailport=s,label=" else  "]
node2 -> node13[headport=n, tailport=s,label="   "]
node3 -> node14[headport=n, tailport=s,label="LenghtTest(1, $name = GetCollum(1) , 3, 20)"]
node3 -> node15[headport=n, tailport=s,label=" else  "]
node4 -> node16[headport=n, tailport=s,label="LenghtTest(1, $oldPas = GetCollum(1) , 5, 20, false)"]
node4 -> node17[headport=n, tailport=s,label=" else  "]
node5 -> node18[headport=n, tailport=s,label="   "]
node6 -> node19[headport=n, tailport=s,label="IsRefreshed(\"Byl jste přihlášen\")"]
node6 -> node20[headport=n, tailport=s,label=" else  "]
node7 -> node21[headport=n, tailport=s,label="!$data"]
node7 -> node22[headport=n, tailport=s,label=" else  "]
node8 -> node23[headport=n, tailport=s,label="AUTORIZACE != \"Q.&dJhůs63d5dS=d56sLc5%\" or !AUTORIZACE"]
node8 -> node24[headport=n, tailport=s,label=" else  "]
node9 -> node25[headport=n, tailport=s,label="   "]
node10 -> node25[headport=n, tailport=s,label="   "]
node11 -> node26[headport=n, tailport=s,label="   "]
node12 -> node27[headport=n, tailport=s,label="IsLoged() and $_inf['log'] != 'login'"]
node12 -> node28[headport=n, tailport=s,label=" else  "]
node14 -> node30[headport=n, tailport=s,label="   "]
node15 -> node31[headport=n, tailport=s,label="LenghtTest(2, $pass = GetCollum(2) , 5, 20, false)"]
node15 -> node32[headport=n, tailport=s,label=" else  "]
node16 -> node34[headport=n, tailport=s,label="   "]
node17 -> node35[headport=n, tailport=s,label="LenghtTest(2, $name = GetCollum(2) , 3, 20)"]
node17 -> node36[headport=n, tailport=s,label=" else  "]
node19 -> node38[headport=n, tailport=s,label="   "]
node20 -> node38[headport=n, tailport=s,label="   "]
node21 -> node40[headport=n, tailport=s,label="   "]
node22 -> node41[headport=n, tailport=s,label="IsRefreshed(\"Údaje změněny\")"]
node22 -> node42[headport=n, tailport=s,label=" else  "]
node23 -> node24[headport=n, tailport=s,label="   "]
node24 -> node44[headport=n, tailport=s,label="$_GET['o'] == 'logout'"]
node24 -> node45[headport=n, tailport=s,label=" else  "]
node27 -> node46[headport=n, tailport=s,label="   "]
node28 -> node46[headport=n, tailport=s,label="   "]
node29 -> node12[headport=n, tailport=s,label="   "]
node31 -> node30[headport=n, tailport=s,label="   "]
node32 -> node50[headport=n, tailport=s,label="$data"]
node32 -> node49[headport=n, tailport=s,label=" else  "]
node33 -> node15[headport=n, tailport=s,label="   "]
node35 -> node34[headport=n, tailport=s,label="   "]
node36 -> node52[headport=n, tailport=s,label="LenghtTest(3, $pass = GetCollum(3) , 5, 20, false)"]
node36 -> node58[headport=n, tailport=s,label=" else  "]
node37 -> node17[headport=n, tailport=s,label="   "]
node39 -> node20[headport=n, tailport=s,label="   "]
node41 -> node40[headport=n, tailport=s,label="   "]
node42 -> node61[headport=n, tailport=s,label="$_SESSION['state'] == 2"]
node42 -> node60[headport=n, tailport=s,label=" else  "]
node43 -> node22[headport=n, tailport=s,label="   "]
node44 -> node45[headport=n, tailport=s,label="   "]
node45 -> node63[headport=n, tailport=s,label="   "]
node46 -> node26[headport=n, tailport=s,label="   "]
node47 -> node26[headport=n, tailport=s,label="   "]
node48 -> node30[headport=n, tailport=s,label="   "]
node49 -> node30[headport=n, tailport=s,label="   "]
node50 -> node64[headport=n, tailport=s,label="$data['state'] == 2"]
node50 -> node65[headport=n, tailport=s,label=" else  "]
node51 -> node32[headport=n, tailport=s,label="   "]
node52 -> node34[headport=n, tailport=s,label="   "]
node53 -> node34[headport=n, tailport=s,label="   "]
node54 -> node34[headport=n, tailport=s,label="   "]
node55 -> node34[headport=n, tailport=s,label="   "]
node56 -> node34[headport=n, tailport=s,label="   "]
node57 -> node34[headport=n, tailport=s,label="   "]
node58 -> node53[headport=n, tailport=s,label="GetCollum(4) != $pass"]
node58 -> node66[headport=n, tailport=s,label=" else  "]
node59 -> node36[headport=n, tailport=s,label="   "]
node60 -> node40[headport=n, tailport=s,label="   "]
node61 -> node60[headport=n, tailport=s,label="   "]
node62 -> node42[headport=n, tailport=s,label="   "]
node64 -> node48[headport=n, tailport=s,label="   "]
node65 -> node48[headport=n, tailport=s,label="   "]
node66 -> node54[headport=n, tailport=s,label="MailTest(5, $mail = GetCollum(5) , false)"]
node66 -> node67[headport=n, tailport=s,label=" else  "]
node67 -> node55[headport=n, tailport=s,label="!$data"]
node67 -> node72[headport=n, tailport=s,label=" else  "]
node68 -> node56[headport=n, tailport=s,label="!$dotaz"]
node68 -> node57[headport=n, tailport=s,label=" else  "]
node69 -> node57[headport=n, tailport=s,label="   "]
node70 -> node58[headport=n, tailport=s,label="   "]
node71 -> node66[headport=n, tailport=s,label="   "]
node72 -> node77[headport=n, tailport=s,label="$name != $data['name']"]
node72 -> node78[headport=n, tailport=s,label=" else  "]
node73 -> node67[headport=n, tailport=s,label="   "]
node74 -> node68[headport=n, tailport=s,label="   "]
node75 -> node68[headport=n, tailport=s,label="   "]
node76 -> node81[headport=n, tailport=s,label="$mail != $data['mail']"]
node76 -> node68[headport=n, tailport=s,label=" else  "]
node77 -> node78[headport=n, tailport=s,label="   "]
node78 -> node84[headport=n, tailport=s,label="$pass"]
node78 -> node76[headport=n, tailport=s,label=" else  "]
node79 -> node72[headport=n, tailport=s,label="   "]
node80 -> node74[headport=n, tailport=s,label="$mail"]
node80 -> node75[headport=n, tailport=s,label=" else  "]
node81 -> node85[headport=n, tailport=s,label="$dotaz"]
node81 -> node80[headport=n, tailport=s,label=" else  "]
node82 -> node76[headport=n, tailport=s,label="   "]
node83 -> node82[headport=n, tailport=s,label="$data['state'] == 2"]
node83 -> node76[headport=n, tailport=s,label=" else  "]
node84 -> node86[headport=n, tailport=s,label="$dotaz"]
node84 -> node83[headport=n, tailport=s,label=" else  "]
node85 -> node80[headport=n, tailport=s,label="   "]
node86 -> node83[headport=n, tailport=s,label="   "]

}

