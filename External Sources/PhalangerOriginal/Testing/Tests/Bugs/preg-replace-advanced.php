[expect exact]
ok
[file]
<?php
	$match = "";
	$pattern = "/(\\n {2,}[\\-\\*])|(\\n\\t{1,}[\\-\\*])|(\\n  (?![\\*\\-]))|(\\n\\t(?![\\*\\-]))|(~~NOTOC~~)|(~~NOCACHE~~)|([ \\t]*={2,}[^\\n]+={2,}[ \\t]*(?=\\n))|(\\n\\^)|(\\n\\|)|(\\*\\*(?=.*\\*\\*))|(\\/\\/(?=[^\\x00]*[^:]\\/\\/))|(__(?=.*__))|(\\x27\\x27(?=.*\\x27\\x27))|(<sub>(?=.*<\\/sub>))|(<sup>(?=.*<\\/sup>))|(<del>(?=.*<\\/del>))|(\\x5C{2}(?=\\s))|(\\x28\\x28(?=.*\\x29\\x29))|(~~INFO:\\w+~~)|(\\n[ \\t]*-{4,}[ \\t]*(?=\\n))|(<nowiki>(?=.*<\\/nowiki>))|(%%(?=.*%%))|(<php>(?=.*<\\/php>))|(<html>(?=.*<\\/html>))|(<code(?=.*<\\/code>))|(<file>(?=.*<\\/file>))|(\\n>{1,})|(8-\\)|8-O|8-o|\\:-\\(|\\:-\\)|\\=\\)|\\:-\\/|\\:-\\\\|\\:-\\?|\\:-D|\\:-P|\\:-o|\\:-O|\\:-x|\\:-X|\\:-\\||;-\\)|\\^_\\^|\\:\\?\\:|\\:\\!\\:|LOL|FIXME|DELETEME)|((?<=^|[\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\x7f])(?:ACL|AFAICS|AFAIK|AJAX|AIM|AOL|API|ASAP|ASCII|ASP|BTW|CGI|CMS|CSS|CVS|DBA|DHTML|DMCA|DNS|DOM|DTD|EOF|EOL|EOM|EOT|ESMTP|FAQ|FDL|FTP|FOSS|FLOSS|FUD|GB|GHz|GIF|GPL|GUI|HTML|HTTP|IANAL|ICANN|ICQ|IE5|IE6|IE|IIRC|IIS|IMAP|IMHO|IMO|IOW|IRC|IRL|ISO|ISP|JDK|JPEG|JPG|JS|KISS|LGPL|LOL|MathML|MB|MHz|MIME|MIT|MML|MP3|MPEG|MSDN|MS|NS4\\.7|NS4|NS6|NS7|OMG|OPML|OS|OSS|OTOH|P2P|PDA|PDF|Perl|PERL|PHP|PICS|PIN|PITA|PNG|POP3|POP|QoS|RAID|RDF|ROTFL|RPC|RSS|RTFM|RTF|SCSI|SDK|SGML|SMIL|SMTP|SOAP|spec|SQL|SSH|SSI|SSL|SVG|TIA|TIFF|TLD|TOC|URI|URL|URN|VBA|VB|W3C|WAN|WAP|WML|WTF\\?|WWW|WYSIWYG|XHTML|XML|XSD|XSL|XSLT|XUL|YMMV)(?=[\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\x7f]))|(\\<-\\>|-\\>|\\<-|\\<\\=\\>|\\=\\>|\\<\\=|\\>\\>|\\<\\<|---|--|\\(c\\)|\\(tm\\)|\\(r\\))|((?<=\\b)\\d+[xX]\\d+(?=\\b))|((?<=^|\\s)'(?=\\S))|((?<=^|\\S)')|((?<=^|\\s)\"(?=\\S))|((?<=^|\\S)\")|(\\[\\[.+?\\]\\])|(\\{\\{rss>[^\\}]+\\}\\})|(\\{\\{[^\\}]+\\}\\})|(\\b(?i)http(?-i):\\/\\/[\\w\\/\\#~:.?+=&%@!\\-.:?\\-;,]+?(?=[.:?\\-;,]*[^\\w\\/\\#~:.?+=&%@!\\-.:?\\-;,]))|(\\b(?i)https(?-i):\\/\\/[\\w\\/\\#~:.?+=&%@!\\-.:?\\-;,]+?(?=[.:?\\-;,]*[^\\w\\/\\#~:.?+=&%@!\\-.:?\\-;,]))|(\\b(?i)telnet(?-i):\\/\\/[\\w\\/\\#~:.?+=&%@!\\-.:?\\-;,]+?(?=[.:?\\-;,]*[^\\w\\/\\#~:.?+=&%@!\\-.:?\\-;,]))|(\\b(?i)gopher(?-i):\\/\\/[\\w\\/\\#~:.?+=&%@!\\-.:?\\-;,]+?(?=[.:?\\-;,]*[^\\w\\/\\#~:.?+=&%@!\\-.:?\\-;,]))|(\\b(?i)wais(?-i):\\/\\/[\\w\\/\\#~:.?+=&%@!\\-.:?\\-;,]+?(?=[.:?\\-;,]*[^\\w\\/\\#~:.?+=&%@!\\-.:?\\-;,]))|(\\b(?i)ftp(?-i):\\/\\/[\\w\\/\\#~:.?+=&%@!\\-.:?\\-;,]+?(?=[.:?\\-;,]*[^\\w\\/\\#~:.?+=&%@!\\-.:?\\-;,]))|(\\b(?i)ed2k(?-i):\\/\\/[\\w\\/\\#~:.?+=&%@!\\-.:?\\-;,]+?(?=[.:?\\-;,]*[^\\w\\/\\#~:.?+=&%@!\\-.:?\\-;,]))|(\\b(?i)irc(?-i):\\/\\/[\\w\\/\\#~:.?+=&%@!\\-.:?\\-;,]+?(?=[.:?\\-;,]*[^\\w\\/\\#~:.?+=&%@!\\-.:?\\-;,]))|(\\b(?i)ldap(?-i):\\/\\/[\\w\\/\\#~:.?+=&%@!\\-.:?\\-;,]+?(?=[.:?\\-;,]*[^\\w\\/\\#~:.?+=&%@!\\-.:?\\-;,]))|(\\b(?i)www?(?-i)\\.[\\w.:?\\-;,]+?\\.[\\w.:?\\-;,]+?[\\w\\/\\#~:.?+=&%@!\\-.:?\\-;,]+?(?=[.:?\\-;,]*[^\\w\\/\\#~:.?+=&%@!\\-.:?\\-;,]))|(\\b(?i)ftp?(?-i)\\.[\\w.:?\\-;,]+?\\.[\\w.:?\\-;,]+?[\\w\\/\\#~:.?+=&%@!\\-.:?\\-;,]+?(?=[.:?\\-;,]*[^\\w\\/\\#~:.?+=&%@!\\-.:?\\-;,]))|(<[\\w0-9\\-_.]+?@[\\w\\-]+\\.[\\w\\-\\.]+\\.*[\\w]+>)|(\\\\\\\\\\w+?(?:\\\\[\\w$]+)+)|(\\n)/msS";

	$test = "\n**This** is my //new// wiki!\n";
  preg_match($pattern, $test, $match);
  echo $match[0] == "\n"?"ok":"error";
?>